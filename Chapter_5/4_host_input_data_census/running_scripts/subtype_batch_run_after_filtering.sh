#!/bin/bash
# census run batch script

# JGI retrieval run below

# INPUT: list of de-duplicated genome ids from each subtype investigated (hardcoded in this instance)
# OUTPUT: tables of JGI annotations for each set of subtype contigs

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas12a.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas12a_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv


python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas12b.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas12b_test_jgi_annotations.csv


python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas12f1.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas12f1_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas12g.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas12g_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas12i.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas12i_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas12j.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas12j_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas12k.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas12k_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas13a.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas13a_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas13b.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas13b_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/cas13d.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/cas13d_test_jgi_annotations.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/fncas9.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/fncas9_test_jgi_annotations.csv>> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/spcas9.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/spcas9_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/typeIA_cas7a.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/typeIA_cas7a_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/typeIB_cas8b.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/typeIB_cas8b_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/typeID_cas10d.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/typeID_cas10d_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/typeIF_csy1.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/typeIF_csy1_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/typeIIIA_cas10.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/typeIIIA_cas10_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv
python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/typeIIIB_cmr2.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/typeIIIB_cmr2_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv
python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/typeIIIE_cas7.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/typeIIIE_cas7_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv
python3.7 jgi_annotation_retrieval.py ../non-redundant_mapping_tables/mapped_spacer_genome_ids/typeVU1.fasta_all_hits.csv_genomes.fasta_crisprs.lst_full_real_arr_positions.csv_all_hits_blast_filtered_hitmap.csv_standardised.csv_non_redundant.csv_filtered.csv_host_ids.csv ../contig_environment_metadata/jgi_microbiome_window_only2_dedup.csv ../non-redundant_mapping_tables/census_subtype_runs/typeVU1_test_jgi_annotations.csv >> ../non-redundant_mapping_tables/census_subtype_runs/jgi_retrieval_readout.csv

